#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
//#include <ioctl.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <linux/ioctl.h>
#include <pthread.h>
#include "public.h"

#include "audio_play.h"

#define SPI_NODE    "/dev/spidev1.3"

static int fd_audio_spi = -1;

static char Soundidlestatus = 1;

//欢迎使用中国南方电网公司为您提供的电动汽车充电服务
unsigned char welcome_use[] = { 0xFD, 0x00, 0x34, 0x01, 0x03, 0x22, 0x6B, 0xCE, 0x8F, 0x7F, 0x4F, 0x28, 0x75, 0x2D,
	0x4E, 0xFD, 0x56, 0x57, 0x53, 0xB9, 0x65, 0x35, 0x75, 0x51, 0x7F, 0x6C, 0x51, 0xF8,
	0x53, 0x3A, 0x4E, 0xA8, 0x60, 0xD0, 0x63, 0x9B, 0x4F, 0x84, 0x76, 0x35, 0x75, 0xA8,
	0x52, 0x7D, 0x6C, 0x66, 0x8F, 0x45, 0x51, 0x35, 0x75, 0x0D, 0x67, 0xA1, 0x52 };
//您当前的余额是
unsigned char current_balance[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xA8, 0x60, 0x53, 0x5F, 0x4D,
	0x52, 0x84, 0x76, 0x59, 0x4F, 0x9D, 0x98, 0x2F, 0x66 };
//元
unsigned char yuan[] = { 0xFD, 0x00, 0x04, 0x01, 0x03, 0x43, 0x51 };
unsigned char yuan_yan[] = { 0x43, 0x51 };
//您的余额不足，请尽快充值
unsigned char money_lack[] = { 0xFD, 0x00, 0x1A, 0x01, 0x03, 0xA8, 0x60, 0x84, 0x76, 0x59,
	0x4F, 0x9D, 0x98, 0x0D, 0x4E, 0xB3, 0x8D, 0x0C, 0xFF, 0xF7,
	0x8B, 0x3D, 0x5C, 0xEB, 0x5F, 0x45, 0x51, 0x3C, 0x50 };
//请打开充电桩插座门，插入电源插头
unsigned char open_door[] = { 0xFD, 0x00, 0x22, 0x01, 0x03, 0xF7, 0x8B, 0x53, 0x62, 0x00, 0x5F, 0x45, 0x51,
	0x35, 0x75, 0x69, 0x68, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95, 0x0C, 0xFF, 0xD2,
	0x63, 0x65, 0x51, 0x35, 0x75, 0x90, 0x6E, 0xD2, 0x63, 0x34, 0x59 };
//请关闭插座门
unsigned char close_door[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0xF7, 0x8B, 0x73, 0x51, 0xED, 0x95, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95 };
//充电即将开始。请勿移动车辆
unsigned char charge_start[] = { 0xFD, 0x00, 0x1C, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x73, 0x53,
	0x06, 0x5C, 0x00, 0x5F, 0xCB, 0x59, 0x02, 0x30, 0xF7, 0x8B, 0xFF,
	0x52, 0xFB, 0x79, 0xA8, 0x52, 0x66, 0x8F, 0x86, 0x8F };
//开始进行充电
unsigned char start_charge[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0x00, 0x5F, 0xCB, 0x59, 0xDB, 0x8F, 0x4C, 0x88, 0x45, 0x51, 0x35, 0x75 };
//充电结束
unsigned char charge_end[] = { 0xFD, 0x00, 0x0A, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67 };
//本次消费金额
unsigned char cousume_money[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0x2C, 0x67, 0x21, 0x6B,
	0x88, 0x6D, 0x39, 0x8D, 0xD1, 0x91, 0x9D, 0x98 };
//请取卡
unsigned char fetch_card[] = { 0xFD, 0x00, 0x08, 0x01, 0x03, 0xF7, 0x8B, 0xD6, 0x53, 0x61, 0x53 };
//谢谢使用，再见 
unsigned char thank_use[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0x22, 0x8C, 0x22, 0x8C, 0x7F, 0x4F, 0x28, 0x75, 0x0C, 0xFF, 0x8D, 0x51, 0xC1, 0x89 };
//卡号不正确，请使用同一张卡
unsigned char cardnumber_error[] = { 0xFD, 0x00, 0x1C, 0x01, 0x03, 0x61, 0x53, 0xF7, 0x53, 0x0D, 0x4E, 0x63, 0x6B, 0x6E, 0x78, 0x0C,
	0xFF, 0xF7, 0x8B, 0x7F, 0x4F, 0x28, 0x75, 0x0C, 0x54, 0x00, 0x4E, 0x20, 0x5F, 0x61, 0x53 };
//请使用南方电网公司汽车充电卡
unsigned char southelec_card[] = { 0xFD, 0x00, 0x1E, 0x01, 0x03, 0xF7, 0x8B, 0x7F, 0x4F, 0x28, 0x75, 0x57, 0x53, 0xB9, 0x65, 0x35, 0x75,
	0x51, 0x7F, 0x6C, 0x51, 0xF8, 0x53, 0x7D, 0x6C, 0x66, 0x8F, 0x45, 0x51, 0x35, 0x75, 0x61, 0x53 };
//电已充满，请插卡付费
unsigned char elec_full[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x35, 0x75, 0xF2, 0x5D, 0x45, 0x51, 0xE1, 0x6E,
	0x0C, 0xFF, 0xF7, 0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//充电故障，已终止充电
unsigned char charge_failure[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x45, 0x65, 0x9C, 0x96,
	0x0C, 0xFF, 0xF2, 0x5D, 0xC8, 0x7E, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//该卡已锁，请解锁卡后使用
unsigned char card_lock[] = { 0xFD, 0x00, 0x1A, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0xF2, 0x5D, 0x01, 0x95, 0x0C, 0xFF,
	0xF7, 0x8B, 0xD0, 0x59, 0x01, 0x95, 0x61, 0x53, 0x0E, 0x54, 0x7F, 0x4F, 0x28, 0x75 };
//请插好充电插头，关好插座门
unsigned char insert_chargeplug[] = { 0xFD, 0x00, 0x1C, 0x01, 0x03, 0xF7, 0x8B, 0xD2, 0x63, 0x7D, 0x59, 0x45, 0x51, 0x35, 0x75, 0xD2,
	0x63, 0x34, 0x59, 0x0C, 0xFF, 0x73, 0x51, 0x7D, 0x59, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95 };
//请打开插座门，取出充电插头
unsigned char open_socketdoor[] = { 0xFD, 0x00, 0x1C, 0x01, 0x03, 0xF7, 0x8B, 0x53, 0x62, 0x00, 0x5F, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95,
	0x0C, 0xFF, 0xD6, 0x53, 0xFA, 0x51, 0x45, 0x51, 0x35, 0x75, 0xD2, 0x63, 0x34, 0x59 };
//请拔掉充电插头，关好插座门
unsigned char unlatch_chargeplug[] = { 0xFD, 0x00, 0x1C, 0x01, 0x03, 0xF7, 0x8B, 0xD4, 0x62, 0x89, 0x63, 0x45, 0x51, 0x35, 0x75, 0xD2,
	0x63, 0x34, 0x59, 0x0C, 0xFF, 0x73, 0x51, 0x7D, 0x59, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95 };
//余额不足，已终止充电
unsigned char moneylack_final[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x59, 0x4F, 0x9D, 0x98, 0x0D, 0x4E, 0xB3, 0x8D,
	0x0C, 0xFF, 0xF2, 0x5D, 0xC8, 0x7E, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//您上次充电费用已扣除
unsigned char chargefare_deduct[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0xA8, 0x60, 0x0A, 0x4E, 0x21, 0x6B, 0x45, 0x51,
	0x35, 0x75, 0x39, 0x8D, 0x28, 0x75, 0xF2, 0x5D, 0x63, 0x62, 0x64, 0x96 };
//电表通信故障，充电结束，请插卡付费
unsigned char meter_com_fault[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x1A, 0x90, 0xE1, 0x4F, 0x45,
	0x65, 0x9C, 0x96, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C,
	0xFF, 0xF7, 0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//读卡器通信故障，充电结束，禁止插卡操作
unsigned char cardreader_com_fault[] = { 0xFD, 0x00, 0x28, 0x01, 0x03, 0xFB, 0x8B, 0x61, 0x53, 0x68, 0x56, 0x1A, 0x90, 0xE1,
	0x4F, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F,
	0x67, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0xD2, 0x63, 0x61, 0x53, 0xCD, 0x64, 0x5C, 0x4F };
//维修门打开，充电结束，请插卡付费
unsigned char maintaindoor_open_fare[] = { 0xFD, 0x00, 0x22, 0x01, 0x03, 0xF4, 0x7E, 0xEE, 0x4F, 0xE8, 0x95, 0x53, 0x62, 0x00,
	0x5F, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//维修门打开，禁止充电
unsigned char maintaindoor_open_forbid[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0xF4, 0x7E, 0xEE, 0x4F, 0xE8, 0x95, 0x53, 0x62, 0x00,
	0x5F, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//维修门打开，请关闭维修门再充电
unsigned char maintaindoor_close[] = { 0xFD, 0x00, 0x20, 0x01, 0x03, 0xF4, 0x7E, 0xEE, 0x4F, 0xE8, 0x95, 0x53, 0x62,
	0x00, 0x5F, 0x0C, 0xFF, 0xF7, 0x8B, 0x73, 0x51, 0xED, 0x95, 0xF4, 0x7E, 0xEE,
	0x4F, 0xE8, 0x95, 0x8D, 0x51, 0x45, 0x51, 0x35, 0x75 };
//电表通信故障，已暂停服务
unsigned char meter_fault_stop[] = { 0xFD, 0x00, 0x1A, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x1A, 0x90, 0xE1, 0x4F, 0x45, 0x65,
	0x9C, 0x96, 0x0C, 0xFF, 0xF2, 0x5D, 0x82, 0x66, 0x5C, 0x50, 0x0D, 0x67, 0xA1, 0x52 };
//读卡器通信故障，禁止插卡操作
unsigned char cardreader_fault_forbid[] = { 0xFD, 0x00, 0x1E, 0x01, 0x03, 0xFB, 0x8B, 0x61, 0x53, 0x68, 0x56, 0x1A, 0x90,
	0xE1, 0x4F, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0xD2,
	0x63, 0x61, 0x53, 0xCD, 0x64, 0x5C, 0x4F };
//29、充电桩异常，暂停服务
unsigned char stake_abnor_forbid[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x69, 0x68, 0x02, 0x5F, 0x38, 0x5E,
	0x0C, 0xFF, 0x82, 0x66, 0x5C, 0x50, 0x0D, 0x67, 0xA1, 0x52 };
//30、充电桩已断电，充电结束，请插卡付费
unsigned char stake_broken_elec[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x69, 0x68, 0xF2, 0x5D, 0xAD, 0x65,
	0x35, 0x75, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//31、电表A相过压，充电结束，请插卡付费
unsigned char meter_A_excessvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x8B, 0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//32、电表B相过压，充电结束，请插卡付费
unsigned char meter_B_excessvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x8B, 0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//33、电表C相过压，充电结束，请插卡付费
unsigned char meter_C_excessvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x8B, 0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//34、电表A相欠压，充电结束，请插卡付费
unsigned char meter_A_fewvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0x20, 0x6B, 0x8B,
	0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//35、电表B相欠压，充电结束，请插卡付费
unsigned char meter_B_fewvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0x20, 0x6B, 0x8B,
	0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//36、电表C相欠压，充电结束，请插卡付费
unsigned char meter_C_fewvol[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0x20, 0x6B, 0x8B,
	0x53, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//37、电表A相过流，充电结束，请插卡付费
unsigned char meter_A_excesscur[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x41, 0x6D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//38、电表B相过流，充电结束，请插卡付费
unsigned char meter_B_excesscur[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x41, 0x6D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//39、电表C相过流，充电结束，请插卡付费
unsigned char meter_C_excesscur[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xC7, 0x8F,
	0x41, 0x6D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//40、电表A相断相，充电结束，请插卡付费
unsigned char meter_A_brokenphase[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xAD, 0x65,
	0xF8, 0x76, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//41、电表B相断相，充电结束，请插卡付费
unsigned char meter_B_brokenphase[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xAD, 0x65,
	0xF8, 0x76, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//42、电表C相断相，充电结束，请插卡付费
unsigned char meter_C_brokenphase[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xAD, 0x65,
	0xF8, 0x76, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7,
	0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//43、电表A相短路，充电结束，请插卡付费
unsigned char meter_A_short[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xED, 0x77, 0xEF,
	0x8D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//44、电表B相短路，充电结束，请插卡付费
unsigned char meter_B_short[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xED, 0x77, 0xEF,
	0x8D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };
//45、电表C相短路，充电结束，请插卡付费
unsigned char meter_C_short[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xED, 0x77, 0xEF,
	0x8D, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F, 0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2,
	0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//46、充电桩停电，禁止充电
unsigned char stake_stop_forbidcharge[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x69, 0x68, 0x5C, 0x50, 0x35,
	0x75, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//47、电表A相过压，禁止充电
unsigned char meter_A_excessvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//48、电表B相过压，禁止充电
unsigned char meter_B_excessvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//49、电表C相过压，禁止充电
unsigned char meter_C_excessvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//50、电表A相欠压，禁止充电
unsigned char meter_A_fewvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0x20, 0x6B,
	0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//51、电表B相欠压，禁止充电
unsigned char meter_B_fewvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0x20, 0x6B,
	0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//52、电表C相欠压，禁止充电
unsigned char meter_C_fewvol_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0x20, 0x6B,
	0x8B, 0x53, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//53、电表A相过流，禁止充电
unsigned char meter_A_excesscur_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x41, 0x6D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//54、电表B相过流，禁止充电
unsigned char meter_B_excesscur_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x41, 0x6D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//55、电表C相过流，禁止充电
unsigned char meter_C_excesscur_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xC7,
	0x8F, 0x41, 0x6D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//56、电表A相断相，禁止充电
unsigned char meter_A_brokenphase_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xAD,
	0x65, 0xF8, 0x76, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//57、电表B相断相，禁止充电
unsigned char meter_B_brokenphase_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xAD,
	0x65, 0xF8, 0x76, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//58、电表C相断相，禁止充电
unsigned char meter_C_brokenphase_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xAD,
	0x65, 0xF8, 0x76, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//59、电表A相短路，禁止充电
unsigned char meter_A_short_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x41, 0x00, 0x61, 0x8C, 0xED, 0x77,
	0xEF, 0x8D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//60、电表B相短路，禁止充电
unsigned char meter_B_short_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x42, 0x00, 0x61, 0x8C, 0xED, 0x77,
	0xEF, 0x8D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//61、电表C相短路，禁止充电
unsigned char meter_C_short_forbid[] = { 0xFD, 0x00, 0x18, 0x01, 0x03, 0x35, 0x75, 0x68, 0x88, 0x43, 0x00, 0x61, 0x8C, 0xED, 0x77,
	0xEF, 0x8D, 0x0C, 0xFF, 0x81, 0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//63、该卡为功能测试卡
unsigned char functiontest_card[] = { 0xFD, 0x00, 0x12, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x3A, 0x4E, 0x9F, 0x52, 0xFD, 0x80, 0x4B,
	0x6D, 0xD5, 0x8B, 0x61, 0x53 };
//64、该卡为充电管理卡
unsigned char chargemanage_card[] = { 0xFD, 0x00, 0x12, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x2F, 0x55, 0x45, 0x51, 0x35, 0x75, 0xA1,
	0x7B, 0x06, 0x74, 0x61, 0x53 };
//65、该卡为修改密钥卡，正在修改密钥中
unsigned char modifycode_card[] = { 0xFD, 0x00, 0x22, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x2F, 0x55, 0xEE, 0x4F, 0x39, 0x65, 0xC6,
	0x5B, 0xA5, 0x94, 0x61, 0x53, 0x0C, 0xFF, 0x63, 0x6B, 0x28, 0x57, 0xEE, 0x4F, 0x39, 0x65, 0xC6,
	0x5B, 0xA5, 0x94, 0x2D, 0x4E };
//66、修改密钥成功
unsigned char modifycode_success[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0xEE, 0x4F, 0x39, 0x65, 0xC6, 0x5B, 0xA5, 0x94, 0x10, 0x62,
	0x9F, 0x52 };
//67、修改密钥失败
unsigned char modifycode_fail[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0xEE, 0x4F, 0x39, 0x65, 0xC6, 0x5B, 0xA5, 0x94, 0x31, 0x59, 0x25, 0x8D };
//68、该卡为密钥修改卡，请在未充电时使用
unsigned char modifycode_card_nocharge[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x2F, 0x55, 0xC6, 0x5B, 0xA5, 0x94,
	0xEE, 0x4F, 0x39, 0x65, 0x61, 0x53, 0x0C, 0xFF, 0xF7, 0x8B, 0x28, 0x57, 0x2A, 0x67, 0x45,
	0x51, 0x35, 0x75, 0xF6, 0x65, 0x7F, 0x4F, 0x28, 0x75 };
//69、该故障检修卡不能在此终端使用
unsigned char failuremodify_card[] = { 0xFD, 0x00, 0x1E, 0x01, 0x03, 0xE5, 0x8B, 0x45, 0x65, 0x9C, 0x96, 0xC0, 0x68, 0xEE, 0x4F,
	0x61, 0x53, 0x0D, 0x4E, 0xFD, 0x80, 0x28, 0x57, 0x64, 0x6B, 0xC8, 0x7E, 0xEF, 0x7A, 0x7F,
	0x4F, 0x28, 0x75 };
//70、该充电管理卡不能再此终端使用
unsigned char chargemange_card_nouse[] = { 0xFD, 0x00, 0x1E, 0x01, 0x03, 0xE5, 0x8B, 0x45, 0x51, 0x35, 0x75, 0xA1, 0x7B, 0x06,
	0x74, 0x61, 0x53, 0x0D, 0x4E, 0xFD, 0x80, 0x8D, 0x51, 0x64, 0x6B, 0xC8, 0x7E, 0xEF,
	0x7A, 0x7F, 0x4F, 0x28, 0x75 };
//71、该卡为功能测试卡，请在未充电状态下使用
unsigned char functiontest_card_nocharge[] = { 0xFD, 0x00, 0x28, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x3A, 0x4E, 0x9F, 0x52,
	0xFD, 0x80, 0x4B, 0x6D, 0xD5, 0x8B, 0x61, 0x53, 0x0C, 0xFF, 0xF7, 0x8B, 0x28,
	0x57, 0x2A, 0x67, 0x45, 0x51, 0x35, 0x75, 0xB6, 0x72, 0x01, 0x60, 0x0B, 0x4E,
	0x7F, 0x4F, 0x28, 0x75 };
//72、开始进入功能测试
unsigned char start_functiontest[] = { 0xFD, 0x00, 0x12, 0x01, 0x03, 0x00, 0x5F, 0xCB, 0x59, 0xDB, 0x8F, 0x65, 0x51, 0x9F, 0x52,
	0xFD, 0x80, 0x4B, 0x6D, 0xD5, 0x8B };
//73、请打开插座门
unsigned char openplug_door[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0xF7, 0x8B, 0x53, 0x62, 0x00, 0x5F, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95 };
//74、功能测试完成
unsigned char functiontest_finish[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0x9F, 0x52, 0xFD, 0x80, 0x4B, 0x6D, 0xD5, 0x8B, 0x8C, 0x5B, 0x10, 0x62 };
//75、终端来电
unsigned char terminate_elec[] = { 0xFD, 0x00, 0x0A, 0x01, 0x03, 0xC8, 0x7E, 0xEF, 0x7A, 0x65, 0x67, 0x35, 0x75 };
//76、维修门打开，已暂停充电，可插卡付费，结束本次充电
unsigned char maintaindoor_pause_fare_finish[] = { 0xFD, 0x00, 0x32, 0x01, 0x03, 0xF4, 0x7E, 0xEE, 0x4F, 0xE8, 0x95, 0x53, 0x62, 0x00,
	0x5F, 0x0C, 0xFF, 0xF2, 0x5D, 0x82, 0x66, 0x5C, 0x50, 0x45, 0x51, 0x35, 0x75, 0x0C,
	0xFF, 0xEF, 0x53, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D, 0x0C, 0xFF, 0xD3,
	0x7E, 0x5F, 0x67, 0x2C, 0x67, 0x21, 0x6B, 0x45, 0x51, 0x35, 0x75 };
//77、备用电池电压低，暂停服务
unsigned char sparebattery_vol_low_pause[] = { 0xFD, 0x00, 0x1A, 0x01, 0x03, 0x07, 0x59, 0x28, 0x75, 0x35, 0x75, 0x60, 0x6C, 0x35, 0x75,
	0x8B, 0x53, 0x4E, 0x4F, 0x0C, 0xFF, 0x82, 0x66, 0x5C, 0x50, 0x0D, 0x67, 0xA1, 0x52 };
//78、该卡为故障检修卡	                              
unsigned char failure_modify_card[] = { 0xFD, 0x00, 0x12, 0x01, 0x03, 0xE5, 0x8B, 0x61, 0x53, 0x2F, 0x55, 0x45, 0x65, 0x9C, 0x96,
	0xC0, 0x68, 0xEE, 0x4F, 0x61, 0x53 };
//79、充电枪断开连接，充电结束，请插卡付费
unsigned char chargegun_open_chargefinish[] = { 0xFD, 0x00, 0x26, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0xAA, 0x67, 0xAD, 0x65, 0x00,
	0x5F, 0xDE, 0x8F, 0xA5, 0x63, 0x0C, 0xFF, 0x45, 0x51, 0x35, 0x75, 0xD3, 0x7E, 0x5F,
	0x67, 0x0C, 0xFF, 0xF7, 0x8B, 0xD2, 0x63, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//80、充电桩故障，已结束充电，请刷卡付费
unsigned char PaleExcepEndCharge[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x69, 0x68, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0xF2,
	0x5D, 0xD3, 0x7E, 0x5F, 0x67, 0x45, 0x51, 0x35, 0x75, 0x0C, 0xFF, 0xF7, 0x8B, 0x37, 0x52, 0x61, 0x53, 0xD8,
	0x4E, 0x39, 0x8D };

//81、充电桩故障，禁止充电
unsigned char PaleExcepIdle[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x69, 0x68, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0x81,
	0x79, 0x62, 0x6B, 0x45, 0x51, 0x35, 0x75 };

//82、读卡器通信故障，已结束充电，请勿刷卡付费
unsigned char CardExcepEndCharge[] = { 0xFD, 0x00, 0x2A, 0x01, 0x03, 0xFB, 0x8B, 0x61, 0x53, 0x68, 0x56, 0x1A, 0x90, 0xE1, 0x4F, 0x45, 0x65, 0x9C, 0x96,
	0x0C, 0xFF, 0xF2, 0x5D, 0xD3, 0x7E, 0x5F, 0x67, 0x45, 0x51, 0x35, 0x75, 0x0C, 0xFF, 0xF7, 0x8B, 0xFF, 0x52, 0x37,
	0x52, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//83、充电完成,请刷卡付费
unsigned char ChargeComplete[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0x8C, 0x5B, 0x10, 0x62, 0x2C, 0x00, 0xF7, 0x8B, 0x37, 0x52,
	0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//84、请选择充电模式
unsigned char SelChargeMode[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0x09, 0x90, 0xE9, 0x62, 0x45, 0x51, 0x35, 0x75, 0x21, 0x6A, 0x0F, 0x5F };

//85、请输入充电电量
unsigned char InputEle[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0x93, 0x8F, 0x65, 0x51, 0x45, 0x51, 0x35, 0x75, 0x35, 0x75, 0xCF, 0x91 };

//86、请输入充电金额
unsigned char InputMoney[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0x93, 0x8F, 0x65, 0x51, 0x45, 0x51, 0x35, 0x75, 0xD1, 0x91, 0x9D, 0x98 };

//87、请输入充电时间
unsigned char InputTime[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0x93, 0x8F, 0x65, 0x51, 0x45, 0x51, 0x35, 0x75, 0xF6, 0x65, 0xF4, 0x95 };

//88、请刷卡
unsigned char BrashCard[] = { 0xFD, 0x00, 0x08, 0x01, 0x03, 0xF7, 0x8B, 0x37, 0x52, 0x61, 0x53 };

//89、请打开插座门
//unsigned char Open_Door[] = { 0xFD, 0x00, 0x0E, 0x01, 0x03, 0xF7, 0x8B, 0x53, 0x62, 0x00, 0x5F, 0xD2, 0x63, 0xA7, 0x5E, 0xE8, 0x95};

//90、请插好充电插头
unsigned char PushPlug[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0xD2, 0x63, 0x7D, 0x59, 0x45, 0x51, 0x35, 0x75, 0xD2, 0x63, 0x34, 0x59 };

//91、请拔掉充电插头
unsigned char PullPlug[] = { 0xFD, 0x00, 0x10, 0x01, 0x03, 0xF7, 0x8B, 0xD4, 0x62, 0x89, 0x63, 0x45, 0x51, 0x35, 0x75, 0xD2, 0x63, 0x34, 0x59 };

//92、输入错误，请重新输入
unsigned char InputError[] = { 0xFD, 0x00, 0x16, 0x01, 0x03, 0x93, 0x8F, 0x65, 0x51, 0x19, 0x95, 0xEF, 0x8B, 0x0C, 0xFF, 0xF7, 0x8B, 0xCD, 0x91,
	0xB0, 0x65, 0x93, 0x8F, 0x65, 0x51 };

//93、请输入预约充电时间
unsigned char InputPreChargeTime[] = { 0xFD, 0x00, 0x14, 0x01, 0x03, 0xF7, 0x8B, 0x93, 0x8F, 0x65, 0x51, 0x84, 0x98, 0xA6, 0x7E, 0x45, 0x51, 0x35, 0x75,
	0xF6, 0x65, 0xF4, 0x95 };

//94、余额不足，已结束充电，请刷卡付费
unsigned char NoMoneyInCharging[] = { 0xFD, 0x00, 0x22, 0x01, 0x03, 0x59, 0x4F, 0x9D, 0x98, 0x0D, 0x4E, 0xB3, 0x8D, 0x0C, 0xFF, 0xF2, 0x5D, 0xD3, 0x7E,
	0x5F, 0x67, 0x45, 0x51, 0x35, 0x75, 0x0C, 0xFF, 0xF7, 0x8B, 0x37, 0x52, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//95、显示屏通信故障，本桩暂停服务 
unsigned char ScreenExcep_Idle[] = { 0xFD, 0x00, 0x1E, 0x01, 0x03, 0x3E, 0x66, 0x3A, 0x79, 0x4F, 0x5C, 0x1A, 0x90, 0xE1, 0x4F, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0x2C, 0x67,
	0x69, 0x68, 0x82, 0x66, 0x5C, 0x50, 0x0D, 0x67, 0xA1, 0x52 };

//96、显示屏通信故障，已结束充电，请刷卡付费
unsigned char ScreenExcep_Charging[] = { 0xFD, 0x00, 0x28, 0x01, 0x03, 0x3E, 0x66, 0x3A, 0x79, 0x4F, 0x5C, 0x1A, 0x90, 0xE1, 0x4F, 0x45, 0x65, 0x9C, 0x96, 0x0C, 0xFF, 0xF2,
	0x5D, 0xD3, 0x7E, 0x5F, 0x67, 0x45, 0x51, 0x35, 0x75, 0x0C, 0xFF, 0xF7, 0x8B, 0x37, 0x52, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//97、显示屏通信故障恢复										
unsigned char ScreenExcep_HF[] = { 0xFD, 0x00, 0x14, 0x01, 0x03, 0x3E, 0x66, 0x3A, 0x79, 0x4F, 0x5C, 0x1A, 0x90, 0xE1, 0x4F, 0x45, 0x65, 0x9C, 0x96, 0x62, 0x60, 0x0D, 0x59 };

//98、欢迎光临
unsigned char Welcome[] = { 0xFD, 0x00, 0x0A, 0x01, 0x03, 0x22, 0x6B, 0xCE, 0x8F, 0x49, 0x51, 0x34, 0x4E };

//99、充电枪断开，已结束充电，请刷卡付费
unsigned char Plug_out_Charging[] = { 0xFD, 0x00, 0x24, 0x01, 0x03, 0x45, 0x51, 0x35, 0x75, 0xAA, 0x67, 0xAD, 0x65, 0x00, 0x5F, 0x0C, 0xFF, 0xF2, 0x5D, 0xD3, 0x7E, 0x5F, 0x67,
	0x45, 0x51, 0x35, 0x75, 0x0C, 0xFF, 0xF7, 0x8B, 0x37, 0x52, 0x61, 0x53, 0xD8, 0x4E, 0x39, 0x8D };

//100、读卡器通信故障，可退出服务
unsigned char CardExcep_BrashCard[] = {0xFD,0x00,0x1C,0x01,0x03,0xFB,0x8B,0x61,0x53,0x68,0x56,0x1A,0x90,0xE1,0x4F,0x45,0x65,0x9C,0x96,0x0C,0xFF,0xEF,0x53,0x00,0x90,0xFA,0x51,0x0D,0x67,0xA1,0x52};

//101、充电枪断开，请确认连接

unsigned char PlugOut_BrashCard[] = {0xFD,0x00,0x18,0x01,0x03,0x45,0x51,0x35,0x75,0xAA,0x67,0xAD,0x65,0x00,0x5F,0x0C,0xFF,0xF7,0x8B,0x6E,0x78,0xA4,0x8B,0xDE,0x8F,0xA5,0x63};



static unsigned char CheckEquipmentCmd[] = { 0xFD, 0x00, 0x01, 0x21 };

static unsigned char Playmoney4[] = { 0x35, 0x36, 0x00, 0x20, 0x2E, 0x38, 0x33 };
static unsigned char Playmoney5[] = { 0x36, 0x00, 0x20, 0x38, 0x2E, 0x20, 0x39 };
static unsigned char Playmoney6[] = { 0x34, 0x20, 0x36, 0x38, 0x2E, 0x00, 0x34 };
//static unsigned char Playstr[100];
static int Soundtype;

static int spi_fd = -1;

int audio_play2( unsigned char *rcvbuf, int len );

/********************************************************************************* 
 函数名称： InitMeter
 功能描述：	初始化电表函数，创建表接收和发送线程
 输    入：	无
 输	   出： 无
 返 回 值： 无
 作    者：	yansudan
 日    期：	2011.2.6
 修改记录：
 *********************************************************************************/
void InitSpi( void )
{
#if 0
	ST_INT32 result;
	pthread_t SpiRcvthread;

	result = pthread_create(&SpiRcvthread, PTHREAD_CREATE_JOINABLE, (void *)audio_play2 ,NULL);
	if(result)
	{
		perror("pthread_create: MeterComSend.\n");
		exit(EXIT_FAILURE);
	}
#endif

}

int spi_open( const char *node )
{
#if 0
	int fd;

	if (!node)
	{
		printf("Error: file node NULL\n");
		return -1;
	}
	fd = open(node, O_RDWR);

	return fd<0 ? -2: fd;
#else
	if( !node )
	{
		printf( "Error: file node NULL\n" );
		return -1;
	}
	if( spi_fd > 0 )
		return 0;
	spi_fd = open( node, O_RDWR );
	if( spi_fd < 0 )
	{
		printf( "Error: spi open fail\n" );
		return -1;
	}
	return 0;
#endif
}

int spi_send( int fd, const unsigned char *sendbuf, int size )
{
	int i;
	int ret;
	struct spi_ioc_transfer xfer[1];

	memset( xfer, 0, sizeof( xfer ) );

	xfer[0].tx_buf = ( __u64 ) ( int ) sendbuf;
	xfer[0].len = size;

	ret = ioctl( spi_fd, SPI_IOC_MESSAGE(1), xfer );
	if( ret < 0 )
	{
		printf( "Error: SPI_IOC_MESSAGE\n" );
		return -1;
	}

	//printf("send[%d]: ", ret);
	for( i = 0; i < size; i++ )
		printf( "%02x ", sendbuf[i] );
	printf( "\n" );

	return ret;
}

int spi_recv( int fd, char *recvbuf, int size )
{
//	int i;
	int ret;

	memset( recvbuf, 0, size );

	ret = read( spi_fd, recvbuf, size );
	if( ret < 0 )
	{
		printf( "Error: spi read\n" );
		return -1;
	}

	//printf("read[%d]: ", ret);
//	for(i = 0; i < size; i++)
//		printf("%02x ", recvbuf[i]);
//	printf("\n");

	return ret;
}

void spi_close( int fd )
{
//	int ret;

	/*	ret = close(spi_fd);
	 if (ret == 0) {
	 fd_audio_spi = -1;
	 } else if (ret < 0) {
	 printf("Error: spi close\n");
	 }*/
}

int ___audio_play1( const unsigned char *sendbuf, int len )
{
	//int i;
	
	if( fd_audio_spi < 0 )
	{
		fd_audio_spi = spi_open( SPI_NODE );
		if( fd_audio_spi < 0 )
			exit( 1 );
	}
	spi_send( fd_audio_spi, sendbuf, len );
	spi_close( fd_audio_spi );
	return 1;
}

static ST_CHAR SpiPlayFinishFlag = 0;

int audio_play2( unsigned char *rcvbuf, int len )
{
//	int i;
//	int count = 0;
	//char receivedokflag = 0;
	
	char recvdata;
	SpiPlayFinishFlag = 0;
//	while(1)
	{
		if( fd_audio_spi < 0 )
		{
			fd_audio_spi = spi_open( SPI_NODE );
			if( fd_audio_spi < 0 )
				exit( 1 );
		}
		spi_recv( fd_audio_spi, &recvdata, 1 );
		printf( "recvdata is %2x\n", recvdata );
		if( recvdata == 0x4F )
		{
			SpiPlayFinishFlag = 1;
		}

		printf( "receive data is OK\n" );
		spi_close( fd_audio_spi );
		
	}
	return 1;
}

ST_CHAR IsPlayFinish( void )
{
	unsigned char spircvdata;
	audio_play2( &spircvdata, 1 );
	if( SpiPlayFinishFlag == 1 )
	{
		return 1;
	}
	return 0;
}

int audio_play1( const unsigned char *voice, int size )
{
	int i;
	
	if( fd_audio_spi < 0 )
	{
		fd_audio_spi = spi_open( SPI_NODE );
		if( fd_audio_spi < 0 )
			exit( 1 );
	}

	for( i = 0; i < size; i++ )
	{
		spi_send( fd_audio_spi, voice + i, 1 );
	}
	SpiPlayFinishFlag = 0;
	spi_close( fd_audio_spi );
	return 1;
}

int __audio_play2( char *voice, int size )
{
	int i;
	
	if( fd_audio_spi < 0 )
	{
		fd_audio_spi = spi_open( SPI_NODE );
		if( fd_audio_spi < 0 )
			exit( 1 );
	}

	for( i = 0; i < size; i++ )
	{
		spi_recv( fd_audio_spi, voice + i, 1 );
	}

	spi_close( fd_audio_spi );
	return 1;
}

unsigned char data_snd[] = { 0xFD, 0x00, 20, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00 };
void playdata_sound( unsigned char *data_send, int len )
{
	int i, j;
	unsigned char data_tmp[20] = { 0x00 };
	unsigned char data[20] = { 0x00 };
	memcpy( data, data_send, 8 );
	for( i = 0, j = 0; i < len; i = i + 2, j++ )
	{
		data_tmp[i] = data[j];
	}
	memcpy( &data_snd[5], data_tmp, len );
	strcat(data_snd+5+len,yuan_yan);
	printf( "data_snd is :\n" );
	for( i = 0; i < len + 7; i++ )
		printf( "%x ", data_snd[i] );
}

/******************************************************************************
 ** 函数名称: Playcharacter
 ** 功能描述: 播放不含有金额的字符串
 ** 输入参数: Playstr：播放的字符串，len：字符串字节数
 ** 返回值: 无

 *******************************************************************************/

void Playcharacter( const unsigned char *Playstr, int len )
{
	unsigned char data_rec[100];
	
	audio_play1( Playstr, len );
//	usleep(100*1000);
	audio_play2( data_rec, len );
}

/******************************************************************************
 ** 函数名称: Playdata
 ** 功能描述: 播放含有金额的字符串
 ** 输入参数: Playmoney：播放的字符串，len：字符串字节数
 ** 返回值: 无

 *******************************************************************************/

void Playdata( unsigned char *Playmoney, int len )
{
	unsigned char data_rec[100];
	playdata_sound( Playmoney, len );
	audio_play1( data_snd, len + 7 );
	audio_play2( data_rec, len + 7 );
}

void CheckEquipmentStatus( void )
{
//	int len = 1;
	int count = 0;
	char recvdata;
	audio_play1( CheckEquipmentCmd, sizeof( CheckEquipmentCmd ) );
	spi_recv( fd_audio_spi, &recvdata, 1 );
	while( recvdata != 0x4F )
	{
		usleep( 100 * 1000 );
		spi_recv( fd_audio_spi, &recvdata, 1 );
		count++;
		if( count > 10 )
		{
			count = 0;
			break;
		}
	}
	if( recvdata == 0x4F )
	{
		Soundidlestatus = 1;
	}
	else
	{
		Soundidlestatus = 0;
	}
}

void delay17( void )
{
	int i;
	for( i = 1000000 * 160; i > 0; i-- )
		;
}

void delay6( void )
{
	int i;
	for( i = 1000000 * 80; i > 0; i-- )
		;
}

void delay19( void )
{
	int i;
	for( i = 1000000 * 160; i > 0; i-- )
		;
}

void delay7( void )
{
	int i;
	for( i = 1000000 * 65; i > 0; i-- )
		;
}

/******************************************************************************
 ** 函数名称: PlaySound
 ** 功能描述: 播放不含有金额的字符串
 ** 输入参数: Soundtype：区别不同语音的序号，Playstr：播放的字符串
 ** 返回值: 无

 *******************************************************************************/

void PlaySound( char Soundtype, unsigned char *Playstr )
{
//	int i;
//	CheckEquipmentStatus();
//	if(Soundidlestatus==1)
	{
		switch( Soundtype )
		{
			case 84:
				Playcharacter( SelChargeMode, sizeof( SelChargeMode ) );
				usleep( 1000 * 2000 );
				break;
			case 85:
				Playcharacter( InputEle, sizeof( InputEle ) );
				break;
			case 86:
				Playcharacter( InputMoney, sizeof( InputMoney ) );
				break;
			case 87:
				Playcharacter( InputTime, sizeof( InputTime ) );
				break;
			case 73:
				Playcharacter( openplug_door, sizeof( openplug_door ) );
				break;
			case 90:
				Playcharacter( PushPlug, sizeof( PushPlug ) );

				break;
			case 4:
				Playcharacter( close_door, sizeof( close_door ) );
				break;
			case 93:
				Playcharacter( InputPreChargeTime, sizeof( InputPreChargeTime ) );

				break;
			case 91:
				Playcharacter( PullPlug, sizeof( PullPlug ) );

				break;
			case 92:
				Playcharacter( InputError, sizeof( InputError ) );

				break;
			case 88:
				Playcharacter( BrashCard, sizeof( BrashCard ) );

				break;
			case 83:
				Playcharacter( ChargeComplete, sizeof( ChargeComplete ) );

				break;
			case 80:
				Playcharacter( PaleExcepEndCharge, sizeof( PaleExcepEndCharge ) );

				break;
			case 81:
				Playcharacter( PaleExcepIdle, sizeof( PaleExcepIdle ) );

				break;
			case 82:
				Playcharacter( CardExcepEndCharge, sizeof( CardExcepEndCharge ) );

				break;
			case 94:
				Playcharacter( NoMoneyInCharging, sizeof( NoMoneyInCharging ) );
				break;
			case 95:
				Playcharacter( ScreenExcep_Idle, sizeof( ScreenExcep_Idle ) );
				break;
			case 96:
				Playcharacter( ScreenExcep_Charging, sizeof( ScreenExcep_Charging ) );
				break;
			case 97:
				Playcharacter( ScreenExcep_HF, sizeof( ScreenExcep_HF ) );
				break;
			case 98:
				Playcharacter( Welcome, sizeof( Welcome ) );
				break;
			case 99:
				Playcharacter( Plug_out_Charging, sizeof( Plug_out_Charging ) );
				break;
			case 100:
				Playcharacter( CardExcep_BrashCard, sizeof( CardExcep_BrashCard ) );
				break;
			case 101:
				Playcharacter( PlugOut_BrashCard, sizeof( PlugOut_BrashCard ) );
				break;
			case 1:

				Playcharacter( welcome_use, sizeof( welcome_use ) );
				usleep( 1000 * 6200 );

				break;
			case 2:
				Playcharacter( money_lack, sizeof( money_lack ) );
				usleep( 1000 * 3300 );
				break;
			case 3:
				Playcharacter( open_door, sizeof( open_door ) );
				//	sleep(5);
				break;
				//	case 4:
				//		Playcharacter(close_door,sizeof(close_door));
				//	sleep(2);
				//		break;
			case 5:
				Playcharacter( charge_start, sizeof( charge_start ) );
				//	sleep(4);
				break;
			case 6:
				Playcharacter( start_charge, sizeof( start_charge ) );
				//	for(i=0;i<sizeof(start_charge);i++)
				//	   printf("0x%x ",start_charge[i]);
				//	puts("\n");
				//	delay6();
				usleep( 1000 * 3000 );
				break;
			case 7:
				Playcharacter( charge_end, sizeof( charge_end ) );
				//    delay7();
				usleep( 1000 * 1700 );
				break;
			case 10:
				Playcharacter( fetch_card, sizeof( fetch_card ) );
				usleep( 1000 * 1300 );
				break;
			case 11:
				Playcharacter( thank_use, sizeof( thank_use ) );
				usleep( 1000 * 2500 );
				break;
			case 12:
				Playcharacter( cardnumber_error, sizeof( cardnumber_error ) );
				sleep( 4 );
				break;
			case 13:
				Playcharacter( southelec_card, sizeof( southelec_card ) );
				sleep( 4 );
				break;
			case 14:
				Playcharacter( elec_full, sizeof( elec_full ) );
				sleep( 3 );
				break;
			case 15:
				Playcharacter( charge_failure, sizeof( charge_failure ) );
				sleep( 3 );
				break;
			case 16:
				Playcharacter( card_lock, sizeof( card_lock ) );
				usleep( 1000 * 3400 );
				break;
			case 17:
				Playcharacter( insert_chargeplug, sizeof( insert_chargeplug ) );
				//	delay17();
				//	usleep(1000*4200);
				break;
			case 18:
				Playcharacter( open_socketdoor, sizeof( open_socketdoor ) );
				//	sleep(4);
				break;
			case 19:
				Playcharacter( unlatch_chargeplug, sizeof( unlatch_chargeplug ) );
				//	delay19();
				//	usleep(1000*4200);
				break;
			case 20:
				Playcharacter( moneylack_final, sizeof( moneylack_final ) );
				usleep( 1000 * 3100 );
				break;
			case 21:
				Playcharacter( chargefare_deduct, sizeof( chargefare_deduct ) );
				sleep( 3 );
				break;
			case 22:
				Playcharacter( meter_com_fault, sizeof( meter_com_fault ) );
				break;
			case 23:
				Playcharacter( cardreader_com_fault, sizeof( cardreader_com_fault ) );
				break;
			case 24:
				Playcharacter( maintaindoor_open_fare, sizeof( maintaindoor_open_fare ) );
				break;
			case 25:
				Playcharacter( maintaindoor_open_forbid, sizeof( maintaindoor_open_forbid ) );
				break;
			case 26:
				Playcharacter( maintaindoor_close, sizeof( maintaindoor_close ) );
				break;
			case 27:
				Playcharacter( meter_fault_stop, sizeof( meter_fault_stop ) );
				break;
			case 28:
				Playcharacter( cardreader_fault_forbid, sizeof( cardreader_fault_forbid ) );
				break;
			case 29:
				Playcharacter( stake_abnor_forbid, sizeof( stake_abnor_forbid ) );
				break;
			case 30:
				Playcharacter( stake_broken_elec, sizeof( stake_broken_elec ) );
				sleep( 3 );
				break;
			case 31:
				Playcharacter( meter_A_excessvol, sizeof( meter_A_excessvol ) );
				sleep( 3 );
				break;
			case 32:
				Playcharacter( meter_B_excessvol, sizeof( meter_B_excessvol ) );
				sleep( 3 );
				break;
			case 33:
				Playcharacter( meter_C_excessvol, sizeof( meter_C_excessvol ) );
				sleep( 3 );
				break;
			case 34:
				Playcharacter( meter_A_fewvol, sizeof( meter_A_fewvol ) );
				sleep( 3 );
				break;
			case 35:
				Playcharacter( meter_B_fewvol, sizeof( meter_B_fewvol ) );
				sleep( 3 );
				break;
			case 36:
				Playcharacter( meter_C_fewvol, sizeof( meter_C_fewvol ) );
				sleep( 3 );
				break;
			case 37:
				Playcharacter( meter_A_excesscur, sizeof( meter_A_excesscur ) );
				sleep( 3 );
				break;
			case 38:
				Playcharacter( meter_B_excesscur, sizeof( meter_B_excesscur ) );
				sleep( 3 );
				break;
			case 39:
				Playcharacter( meter_C_excesscur, sizeof( meter_C_excesscur ) );
				sleep( 3 );
				break;
			case 40:
				Playcharacter( meter_A_brokenphase, sizeof( meter_A_brokenphase ) );
				sleep( 3 );
				break;
			case 41:
				Playcharacter( meter_B_brokenphase, sizeof( meter_B_brokenphase ) );
				sleep( 3 );
				break;
			case 42:
				Playcharacter( meter_C_brokenphase, sizeof( meter_C_brokenphase ) );
				sleep( 3 );
				break;
			case 43:
				Playcharacter( meter_A_short, sizeof( meter_A_short ) );
				sleep( 3 );
				break;
			case 44:
				Playcharacter( meter_B_short, sizeof( meter_B_short ) );
				sleep( 3 );
				break;
			case 45:
				Playcharacter( meter_C_short, sizeof( meter_C_short ) );
				sleep( 3 );
				break;
			case 46:
				Playcharacter( stake_stop_forbidcharge, sizeof( stake_stop_forbidcharge ) );
				break;
			case 47:
				Playcharacter( meter_A_excessvol_forbid, sizeof( meter_A_excessvol_forbid ) );
				break;
			case 48:
				Playcharacter( meter_B_excessvol_forbid, sizeof( meter_B_excessvol_forbid ) );
				break;
			case 49:
				Playcharacter( meter_C_excessvol_forbid, sizeof( meter_C_excessvol_forbid ) );
				break;
			case 50:
				Playcharacter( meter_A_fewvol_forbid, sizeof( meter_A_fewvol_forbid ) );
				break;
			case 51:
				Playcharacter( meter_B_fewvol_forbid, sizeof( meter_B_fewvol_forbid ) );
				break;
			case 52:
				Playcharacter( meter_C_fewvol_forbid, sizeof( meter_C_fewvol_forbid ) );
				break;
			case 53:
				Playcharacter( meter_A_excesscur_forbid, sizeof( meter_A_excesscur_forbid ) );
				break;
			case 54:
				Playcharacter( meter_B_excesscur_forbid, sizeof( meter_B_excesscur_forbid ) );
				break;
			case 55:
				Playcharacter( meter_C_excesscur_forbid, sizeof( meter_C_excesscur_forbid ) );
				break;
			case 56:
				Playcharacter( meter_A_brokenphase_forbid, sizeof( meter_A_brokenphase_forbid ) );
				//	 sleep(3);
				break;
			case 57:
				Playcharacter( meter_B_brokenphase_forbid, sizeof( meter_B_brokenphase_forbid ) );
				break;
			case 58:
				Playcharacter( meter_C_brokenphase_forbid, sizeof( meter_C_brokenphase_forbid ) );
				break;
			case 59:
				Playcharacter( meter_A_short_forbid, sizeof( meter_A_short_forbid ) );
				break;
			case 60:
				Playcharacter( meter_B_short_forbid, sizeof( meter_B_short_forbid ) );
				break;
			case 61:
				Playcharacter( meter_C_short_forbid, sizeof( meter_C_short_forbid ) );
				break;
			case 63:
				Playcharacter( functiontest_card, sizeof( functiontest_card ) );
				break;
			case 64:
				Playcharacter( chargemanage_card, sizeof( chargemanage_card ) );
				break;
			case 65:
				Playcharacter( modifycode_card, sizeof( modifycode_card ) );
				break;
			case 66:
				Playcharacter( modifycode_success, sizeof( modifycode_success ) );
				break;
			case 67:
				Playcharacter( modifycode_fail, sizeof( modifycode_fail ) );
				break;
			case 68:
				Playcharacter( modifycode_card_nocharge, sizeof( modifycode_card_nocharge ) );
				break;
			case 69:
				Playcharacter( failuremodify_card, sizeof( failuremodify_card ) );
				break;
			case 70:
				Playcharacter( chargemange_card_nouse, sizeof( chargemange_card_nouse ) );
				break;
			case 71:
				Playcharacter( functiontest_card_nocharge, sizeof( functiontest_card_nocharge ) );
				break;
			case 72:
				Playcharacter( start_functiontest, sizeof( start_functiontest ) );
				break;
				//  case 73:
				//       Playcharacter(openplug_door,sizeof(openplug_door));
				//       break;
			case 74:
				Playcharacter( functiontest_finish, sizeof( functiontest_finish ) );
				break;
			case 75:
				Playcharacter( terminate_elec, sizeof( terminate_elec ) );
				break;
			case 76:
				Playcharacter( maintaindoor_pause_fare_finish, sizeof( maintaindoor_pause_fare_finish ) );
				break;
			case 77:
				Playcharacter( sparebattery_vol_low_pause, sizeof( sparebattery_vol_low_pause ) );
				break;
			case 78:
				Playcharacter( failure_modify_card, sizeof( failure_modify_card ) );
				break;
			case 79:
				Playcharacter( chargegun_open_chargefinish, sizeof( chargegun_open_chargefinish ) );
				break;
			default:
				break;
		}
	}
}

void data_conversion( unsigned char *Playmoney, int len )
{
	int i;
	for( i = 0; i < len; i++ )
		if( Playmoney[i] == 0x20 || Playmoney[i] == 0x00 )
			Playmoney[i] = 0x30;
}

void delay1( void )
{
	int i;
	for( i = 1000000 * 50; i > 0; i-- )
		;
}

/******************************************************************************
 ** 函数名称: PlaySound_Money
 ** 功能描述: 播放含有金额的字符串
 ** 输入参数: Soundtype：区别不同语音的序号，Playmoney：播放的字符串
 ** 返回值: 无

 *******************************************************************************/

void PlaySound_Money( char Soundtype, unsigned char *Playmoney )
{
	unsigned char temp[50] = {0};  
//	CheckEquipmentStatus();
//	if(Soundidlestatus==1)
	{
		switch( Soundtype )
		{
			
			case 62:
				data_conversion( Playmoney, 7 );
				Playcharacter( current_balance, sizeof( current_balance ) );
				usleep( 1000 * 2000 );
				Playdata( Playmoney, 14 );
				usleep( 1000 * 1700 );
				Playcharacter( yuan, sizeof( yuan ) );
				//delay1();
				usleep( 1000 * 1400 );
				break;

			case 8:
				data_conversion( Playmoney, 8 );
				Playcharacter( cousume_money, sizeof( cousume_money ) );
				usleep( 1000 * 2000 );
				Playdata( Playmoney, 16 );
				usleep( 1000 * 2700 );
				Playcharacter( yuan, sizeof( yuan ) );
				//sleep( 1 );
				break;
			case 9:
				data_conversion( Playmoney, 8 );
				
				Playcharacter( current_balance, sizeof( current_balance ) );
				sleep( 2 );
				//memcpy(temp,Playmoney,8);
				//strcat(temp,yuan_yan);
			//	Playdata( temp, 16);
				Playdata( Playmoney, 16 );
				//usleep( 1000 * 1000 );
			//	Playcharacter( yuan, sizeof( yuan ) );
				//sleep( 1 );
				break;
			default:
				break;
		}
	}
}
/*
 void circle_player(void)
 {
 Soundtype=1;
 PlaySound_Money(Soundtype,Playmoney);
 //	sleep(1);
 Soundtype=2;
 PlaySound(Soundtype,Playstr);
 //	sleep(3);
 Soundtype=3;
 PlaySound(Soundtype,Playstr);
 //	sleep(5);
 Soundtype=4;
 PlaySound(Soundtype,Playstr);
 //	sleep(2);
 Soundtype=5;
 PlaySound(Soundtype,Playstr);
 //	sleep(4);
 Soundtype=6;
 PlaySound(Soundtype,Playstr);
 //	sleep(2);
 Soundtype=7;
 PlaySound(Soundtype,Playstr);
 //	sleep(1);
 Soundtype=8;
 PlaySound_Money(Soundtype,Playmoney1);
 //	sleep(1);
 Soundtype=9;
 PlaySound_Money(Soundtype,Playmoney2);
 //	sleep(1);
 Soundtype=10;
 PlaySound(Soundtype,Playstr);
 //    sleep(1);
 Soundtype=11;
 PlaySound(Soundtype,Playstr);
 //	sleep(2);
 Soundtype=12;
 PlaySound(Soundtype,Playstr);
 //	sleep(4);
 Soundtype=13;
 PlaySound(Soundtype,Playstr);
 // 	sleep(4);
 Soundtype=14;
 PlaySound(Soundtype,Playstr);
 //	sleep(3);
 Soundtype=15;
 PlaySound(Soundtype,Playstr);
 //	sleep(3);
 Soundtype=16;
 PlaySound(Soundtype,Playstr);
 //	sleep(3);
 Soundtype=17;
 PlaySound(Soundtype,Playstr);
 //	sleep(4);
 Soundtype=18;
 PlaySound(Soundtype,Playstr);
 //	sleep(4);
 Soundtype=19;
 PlaySound(Soundtype,Playstr);
 //	sleep(4);
 Soundtype=20;
 PlaySound(Soundtype,Playstr);
 //	sleep(3);
 Soundtype=21;
 PlaySound(Soundtype,Playstr);
 }  */

int __main( void )
{
	//PlaySound(Soundtype,Playstr);
	//PlaySound_Money(Soundtype,Playmoney);
	//circle_player();
//	int i,len;
	unsigned char *Playmoney1, *Playmoney2, *Playmoney3;
	Playmoney1 = Playmoney4;
	Playmoney2 = Playmoney5;
	Playmoney3 = Playmoney6;
//	data_conversion(Playmoney5,sizeof(Playmoney5));
	/*	Soundtype=1;
	 PlaySound_Money(Soundtype,Playmoney1);
	 Soundtype=8;
	 PlaySound_Money(Soundtype,Playmoney2);
	 Soundtype=9;
	 PlaySound_Money(Soundtype,Playmoney3);
	 Soundtype=7;
	 PlaySound(Soundtype,NULL);
	 Soundtype=17;
	 PlaySound(Soundtype,NULL);
	 Soundtype=6;
	 PlaySound(Soundtype,NULL);
	 Soundtype=10;
	 PlaySound(Soundtype,Playstr);*/

	while( 1 )
	{
		Playmoney1 = Playmoney4;
		Playmoney2 = Playmoney5;
		Playmoney3 = Playmoney6;
		Soundtype = 1;
		PlaySound_Money( Soundtype, Playmoney1 );
		Soundtype = 3;
		PlaySound( Soundtype, NULL );
		Soundtype = 17;
		PlaySound( Soundtype, NULL );
		Soundtype = 6;
		PlaySound( Soundtype, NULL );
		Soundtype = 10;
		PlaySound( Soundtype, NULL );
		Soundtype = 7;
		PlaySound( Soundtype, NULL );
		Soundtype = 18;
		PlaySound( Soundtype, NULL );
		Soundtype = 19;
		PlaySound( Soundtype, NULL );
		Soundtype = 8;
		PlaySound_Money( Soundtype, Playmoney2 );
		Soundtype = 9;
		PlaySound_Money( Soundtype, Playmoney3 );
		Soundtype = 10;
		PlaySound( Soundtype, NULL );
		Soundtype = 11;
		PlaySound( Soundtype, NULL );
		/*		Soundtype=2;
		 PlaySound(Soundtype,NULL);
		 Soundtype=4;
		 PlaySound(Soundtype,NULL);
		 Soundtype=5;
		 PlaySound(Soundtype,NULL);
		 Soundtype=14;
		 PlaySound(Soundtype,NULL);
		 Soundtype=13;
		 PlaySound(Soundtype,NULL);
		 Soundtype=21;
		 PlaySound(Soundtype,NULL);
		 Soundtype=12;
		 PlaySound(Soundtype,NULL);
		 Soundtype=15;
		 PlaySound(Soundtype,NULL);
		 Soundtype=17;
		 PlaySound(Soundtype,NULL);
		 Soundtype=16;
		 PlaySound(Soundtype,NULL);
		 Soundtype=20;
		 PlaySound(Soundtype,NULL);*/
	}
}

/******************************************************************************
 ** 函数名称: StopCompose
 ** 功能描述: 停止正在播放的音频
 ** 输入参数: Soundtype：区别不同语音的序号，Playmoney：播放的字符串
 ** 返回值: 无

 *******************************************************************************/
void StopCompose( void )
{
	unsigned char PlayStr[] = { 0xFD, 0x00, 0x01, 0x02 };
	Playcharacter( PlayStr, sizeof( PlayStr ) );
}

